<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Game</title>
    <!-- Kita pakai library Prism.js untuk highlight kode -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        /* --- Style Umum --- */
        body { 
            font-family: sans-serif; 
            margin: 0; 
            background: #2d2d2d; 
            color: #ccc; 
        }
        .container { 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
        }
        .preview-section { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            position: relative;
        }
        .preview-section iframe { 
            width: 100%; 
            height: 100vh;
            border: none; 
            background: #fff; 
        }
        .back-link { 
            position: fixed; 
            top: 10px; 
            left: 10px; 
            z-index: 1000; 
            background: #007bff; 
            color: white; 
            padding: 10px; 
            text-decoration: none; 
            border-radius: 5px; 
        }
        .view-code-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .view-code-btn:hover {
            background: #218838;
        }

        /* --- POPUP MODAL --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            overflow: auto;
        }
        .modal-content {
            background-color: #1e1e1e;
            margin: 2% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        .close-modal {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 20px;
        }
        .close-modal:hover,
        .close-modal:focus {
            color: #fff;
        }
        .code-block {
            position: relative;
            margin-bottom: 20px;
        }
        .code-block h3 {
            color: #61dafb;
            margin-bottom: 10px;
        }
        .copy-btn {
            position: absolute;
            top: 40px;
            right: 10px;
            background: #007bff;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            z-index: 10;
            transition: background 0.3s;
        }
        .copy-btn:hover {
            background: #0056b3;
        }
        .copy-btn.copied {
            background: #28a745;
        }
        pre { 
            margin: 0;
            overflow-x: auto;
            background: #2d2d2d !important;
            padding: 15px;
            border-radius: 5px;
        }

        /* --- RESPONSIVITAS --- */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                height: auto;
            }
            .preview-section {
                width: 100%;
                flex: none;
            }
            .preview-section iframe {
                height: 100vh;
            }
            .back-link {
                padding: 8px;
                font-size: 12px;
            }
            .view-code-btn {
                padding: 8px 15px;
                font-size: 12px;
            }
            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <a href="index.html" class="back-link">‚Üê Kembali</a>
    <button class="view-code-btn" onclick="openModal()">üìù Lihat Kode</button>

    <div class="container">
        <div class="preview-section">
            <iframe id="game-frame" src=""></iframe>
        </div>
    </div>

    <!-- Modal Popup untuk Kode -->
    <div id="codeModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="color: #61dafb; margin-top: 0;">Kode Sumber</h2>
            
            <div class="code-block">
                <h3>HTML (index.html)</h3>
                <button class="copy-btn" onclick="copyCode('code-html', this)">üìã Copy</button>
                <pre><code class="language-html" id="code-html"></code></pre>
            </div>

            <div class="code-block">
                <h3>CSS (style.css)</h3>
                <button class="copy-btn" onclick="copyCode('code-css', this)">üìã Copy</button>
                <pre><code class="language-css" id="code-css"></code></pre>
            </div>

            <div class="code-block">
                <h3>JavaScript (script.js)</h3>
                <button class="copy-btn" onclick="copyCode('code-js', this)">üìã Copy</button>
                <pre><code class="language-javascript" id="code-js"></code></pre>
            </div>
        </div>
    </div>

    <!-- Script Prism.js untuk highlight kode -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    
    <!-- Script utama kita -->
    <script>
        // Fungsi untuk membuka modal
        function openModal() {
            document.getElementById('codeModal').style.display = 'block';
            // Highlight kode saat modal dibuka
            setTimeout(() => Prism.highlightAll(), 100);
        }

        // Fungsi untuk menutup modal
        function closeModal() {
            document.getElementById('codeModal').style.display = 'none';
        }

        // Tutup modal jika user klik di luar modal
        window.onclick = function(event) {
            const modal = document.getElementById('codeModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Fungsi untuk copy kode
        function copyCode(elementId, button) {
            const codeElement = document.getElementById(elementId);
            const code = codeElement.textContent;
            
            // Copy ke clipboard
            navigator.clipboard.writeText(code).then(() => {
                // Ubah tampilan tombol
                const originalText = button.textContent;
                button.textContent = '‚úì Copied!';
                button.classList.add('copied');
                
                // Kembalikan tampilan tombol setelah 2 detik
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                alert('Gagal menyalin kode: ' + err);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Ambil nama game dari URL, misal: detail.html?game=game-1
            const urlParams = new URLSearchParams(window.location.search);
            const gameName = urlParams.get('game');

            if (!gameName) {
                document.body.innerHTML = '<h1>Error: Game tidak ditemukan!</h1>';
                return;
            }

            // Path ke folder game
            const gamePath = `games/${gameName}/`;

            // Elemen-elemen yang akan kita isi
            const codeHtml = document.getElementById('code-html');
            const codeCss = document.getElementById('code-css');
            const codeJs = document.getElementById('code-js');
            const gameFrame = document.getElementById('game-frame');

            // Set src iframe untuk preview
            gameFrame.src = gamePath + 'index.html';

            // Fungsi untuk mengambil dan menampilkan kode
            async function loadCode(fileName, elementId) {
                try {
                    const response = await fetch(gamePath + fileName);
                    if (!response.ok) {
                        throw new Error(`Gagal mengambil ${fileName}`);
                    }
                    const code = await response.text();
                    document.getElementById(elementId).textContent = code;
                } catch (error) {
                    document.getElementById(elementId).textContent = `// Gagal memuat kode: ${error.message}`;
                }
            }

            // Muat semua kode
            loadCode('index.html', 'code-html');
            loadCode('style.css', 'code-css');
            loadCode('script.js', 'code-js');
        });
    </script>
</body>
</html>